<script src="../output/budget-visualization.js"></script>
<script src="../output/Chart.min.js"></script>
<div id="budget-input"></div>
<canvas id="chart" width="100" height="100"></canvas>
<script>
function getColors() {
  colors = [];
  for (var ii = 0; ii < 100; ii++) {
    var letters = '0123456789ABCDEF'.split('');
    var color = '#';
    for (var jj = 0; jj < 6; jj++ ) {
        color += letters[Math.floor(Math.random() * 16)];
    }
    colors.push(color);
  }

  return colors;
}

Chart.defaults.global.elements.line['fill'] = false;
var canvas = document.getElementById('chart');
var colors = getColors();

var lineChart;

var displayDiv = document.getElementById('budget-input')
var app = Elm.BudgetVisualization.embed(displayDiv);

app.ports.exportExtrapolation.subscribe(function(extrapolation) {
  // TODO: should make smarter update logic here
  extrapolation.datasets.forEach(function(data, index, array) {
    data.backgroundColor = colors[index % colors.length];
    data.borderColor = colors[index % colors.length];
    data.pointRadius = 0;
  });
  lineChart = new Chart(canvas, {
    type: 'line',
    data: extrapolation,
    options: {
      scales: {
        xAxes: [{
          ticks: {
            autoSkip: true,
            maxTicksLimit: 20
          }
        }]
      }
    }
  });
  console.log(lineChart);
});
</script>
